{"ast":null,"code":"import \"antd/lib/button/style\";\nimport _Button from \"antd/lib/button\";\nimport _classCallCheck from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport \"antd/lib/layout/style\";\nimport _Layout from \"antd/lib/layout\";\n\nvar _dec,\n    _class2,\n    _temp,\n    _jsxFileName = \"/Users/evan/progressMan/src/routes/Business/CRUD/components/index.js\";\n\nimport React from 'react';\nimport { connect } from 'dva';\nimport BaseComponent from 'components/BaseComponent';\nimport Toolbar from 'components/Toolbar';\nimport SearchBar from 'components/SearchBar';\nimport DataTable from 'components/DataTable';\nimport { ModalForm } from 'components/Modal';\nimport createColumns from './columns';\nimport './index.less';\nvar Content = _Layout.Content,\n    Header = _Layout.Header,\n    Footer = _Layout.Footer;\nvar Pagination = DataTable.Pagination;\n\nvar _class = (_dec = connect(function (_ref) {\n  var crud = _ref.crud,\n      loading = _ref.loading;\n  return {\n    crud: crud,\n    loading: loading.models.crud\n  };\n}), _dec(_class2 = (_temp =\n/*#__PURE__*/\nfunction (_BaseComponent) {\n  _inherits(_class2, _BaseComponent);\n\n  function _class2() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, _class2);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(_class2)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      record: null,\n      visible: false,\n      rows: []\n    };\n\n    _this.handleDelete = function (records) {\n      var rows = _this.state.rows;\n\n      _this.props.dispatch({\n        type: 'crud/remove',\n        payload: {\n          records: records,\n          success: function success() {\n            // 如果操作成功，在已选择的行中，排除删除的行\n            _this.setState({\n              rows: rows.filter(function (item) {\n                return !records.some(function (jtem) {\n                  return jtem.rowKey === item.rowKey;\n                });\n              })\n            });\n          }\n        }\n      });\n    };\n\n    return _this;\n  }\n\n  _createClass(_class2, [{\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          crud = _this$props.crud,\n          loading = _this$props.loading,\n          dispatch = _this$props.dispatch;\n      var pageData = crud.pageData,\n          employees = crud.employees;\n      var columns = createColumns(this, employees);\n      var _this$state = this.state,\n          rows = _this$state.rows,\n          record = _this$state.record,\n          visible = _this$state.visible;\n      var searchBarProps = {\n        columns: columns,\n        onSearch: function onSearch(values) {\n          dispatch({\n            type: 'crud/getPageInfo',\n            payload: {\n              pageData: pageData.filter(values).jumpPage(1, 10)\n            }\n          });\n        }\n      };\n      var dataTableProps = {\n        loading: loading,\n        columns: columns,\n        rowKey: 'id',\n        dataItems: pageData,\n        selectType: 'checkbox',\n        showNum: true,\n        isScroll: true,\n        selectedRowKeys: rows.map(function (item) {\n          return item.rowKey;\n        }),\n        onChange: function onChange(_ref2) {\n          var pageNum = _ref2.pageNum,\n              pageSize = _ref2.pageSize;\n          dispatch({\n            type: 'crud/getPageInfo',\n            payload: {\n              pageData: pageData.jumpPage(pageNum, pageSize)\n            }\n          });\n        },\n        onSelect: function onSelect(keys, rows) {\n          return _this2.setState({\n            rows: rows\n          });\n        }\n      };\n      var modalFormProps = {\n        loading: loading,\n        record: record,\n        visible: visible,\n        columns: columns,\n        modalOpts: {\n          width: 700\n        },\n        onCancel: function onCancel() {\n          _this2.setState({\n            record: null,\n            visible: false\n          });\n        },\n        // 新增、修改都会进到这个方法中，\n        // 可以使用主键或是否有record来区分状态\n        onSubmit: function onSubmit(values) {\n          dispatch({\n            type: 'crud/save',\n            payload: {\n              values: values,\n              success: function success() {\n                _this2.setState({\n                  record: null,\n                  visible: false\n                });\n              }\n            }\n          });\n        }\n      };\n      return React.createElement(_Layout, {\n        className: \"full-layout crud-page\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 115\n        },\n        __self: this\n      }, React.createElement(Header, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 116\n        },\n        __self: this\n      }, React.createElement(Toolbar, {\n        appendLeft: React.createElement(_Button.Group, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 119\n          },\n          __self: this\n        }, React.createElement(_Button, {\n          type: \"primary\",\n          icon: \"plus\",\n          onClick: this.onAdd,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 120\n          },\n          __self: this\n        }, \"\\u65B0\\u589E\"), React.createElement(_Button, {\n          disabled: !rows.length,\n          onClick: function onClick(e) {\n            return _this2.onDelete(rows);\n          },\n          icon: \"delete\",\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 123\n          },\n          __self: this\n        }, \"\\u5220\\u9664\")),\n        pullDown: React.createElement(SearchBar, Object.assign({\n          type: \"grid\"\n        }, searchBarProps, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 132\n          },\n          __self: this\n        })),\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 117\n        },\n        __self: this\n      }, React.createElement(SearchBar, Object.assign({\n        group: \"abc\"\n      }, searchBarProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 134\n        },\n        __self: this\n      })))), React.createElement(Content, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137\n        },\n        __self: this\n      }, React.createElement(DataTable, Object.assign({}, dataTableProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138\n        },\n        __self: this\n      }))), React.createElement(Footer, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 140\n        },\n        __self: this\n      }, React.createElement(Pagination, Object.assign({}, dataTableProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 141\n        },\n        __self: this\n      }))), React.createElement(ModalForm, Object.assign({}, modalFormProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 143\n        },\n        __self: this\n      })));\n    }\n  }]);\n\n  return _class2;\n}(BaseComponent), _temp)) || _class2);\n\nexport { _class as default };","map":{"version":3,"sources":["/Users/evan/progressMan/src/routes/Business/CRUD/components/index.js"],"names":["React","connect","BaseComponent","Toolbar","SearchBar","DataTable","ModalForm","createColumns","Content","Header","Footer","Pagination","crud","loading","models","state","record","visible","rows","handleDelete","records","props","dispatch","type","payload","success","setState","filter","item","some","jtem","rowKey","pageData","employees","columns","searchBarProps","onSearch","values","jumpPage","dataTableProps","dataItems","selectType","showNum","isScroll","selectedRowKeys","map","onChange","pageNum","pageSize","onSelect","keys","modalFormProps","modalOpts","width","onCancel","onSubmit","onAdd","length","e","onDelete"],"mappings":"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","sourcesContent":["import React from 'react';\nimport { connect } from 'dva';\nimport { Layout, Button } from 'antd';\nimport BaseComponent from 'components/BaseComponent';\nimport Toolbar from 'components/Toolbar';\nimport SearchBar from 'components/SearchBar';\nimport DataTable from 'components/DataTable';\nimport { ModalForm } from 'components/Modal';\nimport createColumns from './columns';\nimport './index.less';\nconst { Content, Header, Footer } = Layout;\nconst Pagination = DataTable.Pagination;\n\n@connect(({ crud, loading }) => ({\n  crud,\n  loading: loading.models.crud\n}))\nexport default class extends BaseComponent {\n  state = {\n    record: null,\n    visible: false,\n    rows: []\n  };\n\n  handleDelete = records => {\n    const { rows } = this.state;\n\n    this.props.dispatch({\n      type: 'crud/remove',\n      payload: {\n        records,\n        success: () => {\n          // 如果操作成功，在已选择的行中，排除删除的行\n          this.setState({\n            rows: rows.filter(\n              item => !records.some(jtem => jtem.rowKey === item.rowKey)\n            )\n          });\n        }\n      }\n    });\n  };\n\n  render() {\n    const { crud, loading, dispatch } = this.props;\n    const { pageData, employees } = crud;\n    const columns = createColumns(this, employees);\n    const { rows, record, visible } = this.state;\n\n    const searchBarProps = {\n      columns,\n      onSearch: values => {\n        dispatch({\n          type: 'crud/getPageInfo',\n          payload: {\n            pageData: pageData.filter(values).jumpPage(1, 10)\n          }\n        });\n      }\n    };\n\n    const dataTableProps = {\n      loading,\n      columns,\n      rowKey: 'id',\n      dataItems: pageData,\n      selectType: 'checkbox',\n      showNum: true,\n      isScroll: true,\n      selectedRowKeys: rows.map(item => item.rowKey),\n      onChange: ({ pageNum, pageSize }) => {\n        dispatch({\n          type: 'crud/getPageInfo',\n          payload: {\n            pageData: pageData.jumpPage(pageNum, pageSize)\n          }\n        });\n      },\n      onSelect: (keys, rows) => this.setState({ rows })\n    };\n\n    const modalFormProps = {\n      loading,\n      record,\n      visible,\n      columns,\n      modalOpts: {\n        width: 700\n      },\n      onCancel: () => {\n        this.setState({\n          record: null,\n          visible: false\n        });\n      },\n      // 新增、修改都会进到这个方法中，\n      // 可以使用主键或是否有record来区分状态\n      onSubmit: values => {\n        dispatch({\n          type: 'crud/save',\n          payload: {\n            values,\n            success: () => {\n              this.setState({\n                record: null,\n                visible: false\n              });\n            }\n          }\n        });\n      }\n    };\n\n    return (\n      <Layout className=\"full-layout crud-page\">\n        <Header>\n          <Toolbar\n            appendLeft={\n              <Button.Group>\n                <Button type=\"primary\" icon=\"plus\" onClick={this.onAdd}>\n                  新增\n                </Button>\n                <Button\n                  disabled={!rows.length}\n                  onClick={e => this.onDelete(rows)}\n                  icon=\"delete\"\n                >\n                  删除\n                </Button>\n              </Button.Group>\n            }\n            pullDown={<SearchBar type=\"grid\" {...searchBarProps} />}\n          >\n            <SearchBar group=\"abc\" {...searchBarProps} />\n          </Toolbar>\n        </Header>\n        <Content>\n          <DataTable {...dataTableProps} />\n        </Content>\n        <Footer>\n          <Pagination {...dataTableProps} />\n        </Footer>\n        <ModalForm {...modalFormProps} />\n      </Layout>\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module"}