{"ast":null,"code":"import _objectSpread from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport \"antd/lib/modal/style\";\nimport _Modal from \"antd/lib/modal\";\nimport \"antd/lib/transfer/style\";\nimport _Transfer from \"antd/lib/transfer\";\nimport _objectWithoutProperties from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _classCallCheck from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport \"antd/lib/select/style\";\nimport _Select from \"antd/lib/select\";\nvar _jsxFileName = \"/Users/evan/progressMan/src/components/Form/model/transfer.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport $$ from 'cmn-utils';\nvar Option = _Select.Option;\n/**\n *  formItem: {\n      type: 'transfer',\n      modal: true,\n      dataSource: employees,\n      normalize: (value) => value.map(item => item.key)\n    }\n */\n\nvar TransferControlled =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(TransferControlled, _Component);\n\n  function TransferControlled(props) {\n    var _this;\n\n    _classCallCheck(this, TransferControlled);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(TransferControlled).call(this, props));\n\n    _this.triggerChange = function (nextTargetKeys, direction, moveKeys) {\n      var _this$props = _this.props,\n          modal = _this$props.modal,\n          onChange = _this$props.onChange;\n\n      _this.setState({\n        value: nextTargetKeys\n      });\n\n      if (onChange && !modal) {\n        onChange(nextTargetKeys);\n      }\n    };\n\n    _this.showModal = function () {\n      _this.setState({\n        visible: true,\n        value: _this.props.value\n      });\n    };\n\n    _this.hideModal = function () {\n      _this.setState({\n        visible: false\n      });\n    };\n\n    _this.onSubmit = function () {\n      var onChange = _this.props.onChange;\n      var value = _this.state.value;\n\n      _this.setState({\n        visible: false\n      });\n\n      if (onChange) {\n        onChange(value);\n      }\n    };\n\n    _this.onSelectChange = function (value, option) {\n      var onChange = _this.props.onChange;\n\n      _this.setState({\n        value: value\n      });\n\n      onChange && onChange(value);\n    };\n\n    var _value = props.value,\n        dataSource = props.dataSource;\n    _this.state = {\n      value: _value || [],\n      dataSource: dataSource,\n      visible: false\n    };\n    return _this;\n  }\n\n  _createClass(TransferControlled, [{\n    key: \"componentWillReceiveProps\",\n    value: function componentWillReceiveProps(nextProps) {\n      if (this.props.value !== nextProps.value) {\n        this.setState({\n          value: nextProps.value\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this$props2 = this.props,\n          title = _this$props2.title,\n          modal = _this$props2.modal,\n          placeholder = _this$props2.placeholder,\n          otherProps = _objectWithoutProperties(_this$props2, [\"title\", \"modal\", \"placeholder\"]);\n\n      var _this$state = this.state,\n          dataSource = _this$state.dataSource,\n          value = _this$state.value,\n          visible = _this$state.visible;\n      var comp = React.createElement(_Transfer, Object.assign({}, otherProps, {\n        dataSource: dataSource,\n        titles: ['源', '目标'],\n        targetKeys: value,\n        onChange: this.triggerChange,\n        render: function render(item) {\n          return item.title || item.label;\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 84\n        },\n        __self: this\n      }));\n\n      if (modal || otherProps.disabled) {\n        return React.createElement(\"div\", {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96\n          },\n          __self: this\n        }, React.createElement(\"div\", {\n          onClick: otherProps.disabled ? function () {} : this.showModal,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 97\n          },\n          __self: this\n        }, React.createElement(_Select, {\n          readOnly: true,\n          disabled: !!otherProps.disabled,\n          mode: \"multiple\",\n          open: false,\n          value: otherProps.value,\n          onChange: this.onSelectChange,\n          placeholder: placeholder,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 98\n          },\n          __self: this\n        }, otherProps.value && dataSource.filter(function (item) {\n          return otherProps.value.indexOf(item.key) !== -1;\n        }).map(function (item) {\n          return React.createElement(Option, {\n            key: item.key,\n            value: item.key,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 111\n            },\n            __self: this\n          }, item.title || item.label);\n        }))), React.createElement(_Modal, Object.assign({\n          className: \"antui-transfer-modal\",\n          title: '请选择' + title,\n          visible: visible,\n          onOk: this.onSubmit,\n          onCancel: this.hideModal,\n          okText: \"\\u786E\\u5B9A\",\n          cancelText: \"\\u53D6\\u6D88\"\n        }, modal, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 117\n          },\n          __self: this\n        }), comp));\n      }\n\n      return comp;\n    }\n  }]);\n\n  return TransferControlled;\n}(Component);\n/**\n * TransferForm组件\n */\n\n\nTransferControlled.propTypes = {\n  value: PropTypes.array,\n  dataSource: PropTypes.array,\n  onChange: PropTypes.func\n};\nexport default (function (_ref) {\n  var form = _ref.form,\n      name = _ref.name,\n      _ref$formFieldOptions = _ref.formFieldOptions,\n      formFieldOptions = _ref$formFieldOptions === void 0 ? {} : _ref$formFieldOptions,\n      record = _ref.record,\n      initialValue = _ref.initialValue,\n      rules = _ref.rules,\n      onChange = _ref.onChange,\n      dataSource = _ref.dataSource,\n      normalize = _ref.normalize,\n      placeholder = _ref.placeholder,\n      getPopupContainer = _ref.getPopupContainer,\n      otherProps = _objectWithoutProperties(_ref, [\"form\", \"name\", \"formFieldOptions\", \"record\", \"initialValue\", \"rules\", \"onChange\", \"dataSource\", \"normalize\", \"placeholder\", \"getPopupContainer\"]);\n\n  var getFieldDecorator = form.getFieldDecorator;\n  var initval = initialValue;\n\n  if (record) {\n    initval = record[name];\n  } // 如果存在初始值\n\n\n  if (initval !== null && typeof initval !== 'undefined') {\n    if ($$.isFunction(normalize)) {\n      formFieldOptions.initialValue = normalize(initval);\n    } else {\n      formFieldOptions.initialValue = initval;\n    }\n  } // 如果有rules\n\n\n  if (rules && rules.length) {\n    formFieldOptions.rules = rules;\n  } // 如果需要onChange\n\n\n  if (typeof onChange === 'function') {\n    formFieldOptions.onChange = function (value) {\n      return onChange(form, value);\n    }; // form, value\n\n  }\n\n  var props = _objectSpread({\n    placeholder: placeholder || \"\\u8BF7\\u9009\\u62E9\".concat(otherProps.title)\n  }, otherProps);\n\n  return getFieldDecorator(name, formFieldOptions)(React.createElement(TransferControlled, Object.assign({\n    dataSource: dataSource\n  }, props, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187\n    },\n    __self: this\n  })));\n});","map":{"version":3,"sources":["/Users/evan/progressMan/src/components/Form/model/transfer.js"],"names":["React","Component","PropTypes","$$","Option","TransferControlled","props","triggerChange","nextTargetKeys","direction","moveKeys","modal","onChange","setState","value","showModal","visible","hideModal","onSubmit","state","onSelectChange","option","dataSource","nextProps","title","placeholder","otherProps","comp","item","label","disabled","filter","indexOf","key","map","propTypes","array","func","form","name","formFieldOptions","record","initialValue","rules","normalize","getPopupContainer","getFieldDecorator","initval","isFunction","length"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport { Transfer, Modal, Select } from 'antd';\nimport $$ from 'cmn-utils';\n\nconst Option = Select.Option;\n/**\n *  formItem: {\n      type: 'transfer',\n      modal: true,\n      dataSource: employees,\n      normalize: (value) => value.map(item => item.key)\n    }\n */\nclass TransferControlled extends Component {\n  static propTypes = {\n    value: PropTypes.array,\n    dataSource: PropTypes.array,\n    onChange: PropTypes.func\n  };\n\n  constructor(props) {\n    super(props);\n    const { value, dataSource } = props;\n    this.state = {\n      value: value || [],\n      dataSource: dataSource,\n      visible: false\n    };\n  }\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.value !== nextProps.value) {\n      this.setState({ value: nextProps.value });\n    }\n  }\n\n  triggerChange = (nextTargetKeys, direction, moveKeys) => {\n    const { modal, onChange } = this.props;\n    this.setState({ value: nextTargetKeys });\n\n    if (onChange && !modal) {\n      onChange(nextTargetKeys);\n    }\n  };\n\n  showModal = () => {\n    this.setState({\n      visible: true,\n      value: this.props.value\n    });\n  };\n\n  hideModal = () => {\n    this.setState({\n      visible: false\n    });\n  };\n\n  onSubmit = () => {\n    const { onChange } = this.props;\n    const { value } = this.state;\n    this.setState({\n      visible: false\n    });\n    if (onChange) {\n      onChange(value);\n    }\n  };\n\n  onSelectChange = (value, option) => {\n    const { onChange } = this.props;\n    this.setState({\n      value\n    });\n    onChange && onChange(value);\n  };\n\n  render() {\n    const { title, modal, placeholder, ...otherProps } = this.props;\n    const { dataSource, value, visible } = this.state;\n\n    const comp = (\n      <Transfer\n        {...otherProps}\n        dataSource={dataSource}\n        titles={['源', '目标']}\n        targetKeys={value}\n        onChange={this.triggerChange}\n        render={item => item.title || item.label}\n      />\n    );\n\n    if (modal || otherProps.disabled) {\n      return (\n        <div>\n          <div onClick={otherProps.disabled ? () => {} : this.showModal}>\n            <Select\n              readOnly\n              disabled={!!otherProps.disabled}\n              mode=\"multiple\"\n              open={false}\n              value={otherProps.value}\n              onChange={this.onSelectChange}\n              placeholder={placeholder}\n            >\n              {otherProps.value &&\n                dataSource\n                  .filter(item => otherProps.value.indexOf(item.key) !== -1)\n                  .map(item => (\n                    <Option key={item.key} value={item.key}>\n                      {item.title || item.label}\n                    </Option>\n                  ))}\n            </Select>\n          </div>\n          <Modal\n            className=\"antui-transfer-modal\"\n            title={'请选择' + title}\n            visible={visible}\n            onOk={this.onSubmit}\n            onCancel={this.hideModal}\n            okText=\"确定\"\n            cancelText=\"取消\"\n            {...modal}\n          >\n            {comp}\n          </Modal>\n        </div>\n      );\n    }\n\n    return comp;\n  }\n}\n\n/**\n * TransferForm组件\n */\nexport default ({\n  form,\n  name,\n  formFieldOptions = {},\n  record,\n  initialValue,\n  rules,\n  onChange,\n  dataSource,\n  normalize,\n  placeholder,\n  getPopupContainer,\n  ...otherProps\n}) => {\n  const { getFieldDecorator } = form;\n\n  let initval = initialValue;\n\n  if (record) {\n    initval = record[name];\n  }\n\n  // 如果存在初始值\n  if (initval !== null && typeof initval !== 'undefined') {\n    if ($$.isFunction(normalize)) {\n      formFieldOptions.initialValue = normalize(initval);\n    } else {\n      formFieldOptions.initialValue = initval;\n    }\n  }\n\n  // 如果有rules\n  if (rules && rules.length) {\n    formFieldOptions.rules = rules;\n  }\n\n  // 如果需要onChange\n  if (typeof onChange === 'function') {\n    formFieldOptions.onChange = value => onChange(form, value); // form, value\n  }\n\n  const props = {\n    placeholder: placeholder || `请选择${otherProps.title}`,\n    ...otherProps\n  };\n\n  return getFieldDecorator(name, formFieldOptions)(\n    <TransferControlled dataSource={dataSource} {...props} />\n  );\n};\n"]},"metadata":{},"sourceType":"module"}