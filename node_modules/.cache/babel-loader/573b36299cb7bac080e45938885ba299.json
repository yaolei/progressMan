{"ast":null,"code":"import _objectSpread from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/evan/progressMan/src/utils/core.js\";\nimport React from 'react';\nimport dynamic from 'dva/dynamic';\nimport { Route, Switch, Redirect } from 'dva/router';\nimport DocumentTitle from 'react-document-title';\nimport assign from 'object-assign';\nimport $$ from 'cmn-utils';\nimport config from '@/config';\n/**\n * 生成动态组件\n * @param {*} app\n * @param {*} models\n * @param {*} component\n */\n\nexport var dynamicWrapper = function dynamicWrapper(app, _models, component) {\n  return dynamic({\n    app: app,\n    models: function models() {\n      return _models;\n    },\n    component: component\n  });\n};\n/**\n * 生成一组路由\n * @param {*} app\n * @param {*} routesConfig\n */\n\nexport var createRoutes = function createRoutes(app, routesConfig) {\n  return React.createElement(Switch, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 29\n    },\n    __self: this\n  }, routesConfig(app).map(function (config) {\n    return createRoute(app, function () {\n      return config;\n    });\n  }));\n}; // 路由映射表\n\nwindow.dva_router_pathMap = {};\n/**\n * 生成单个路由\n * @param {*} app\n * @param {*} routesConfig\n */\n\nexport var createRoute = function createRoute(app, routesConfig) {\n  var _routesConfig = routesConfig(app),\n      Comp = _routesConfig.component,\n      path = _routesConfig.path,\n      indexRoute = _routesConfig.indexRoute,\n      title = _routesConfig.title,\n      otherProps = _objectWithoutProperties(_routesConfig, [\"component\", \"path\", \"indexRoute\", \"title\"]);\n\n  if (path && path !== '/') {\n    window.dva_router_pathMap[path] = _objectSpread({\n      path: path,\n      title: title\n    }, otherProps); // 为子路由增加parentPath\n\n    if (otherProps.childRoutes && otherProps.childRoutes.length) {\n      otherProps.childRoutes.forEach(function (item) {\n        if (window.dva_router_pathMap[item.key]) {\n          window.dva_router_pathMap[item.key].parentPath = path;\n        }\n      });\n    }\n  }\n\n  var routeProps = assign({\n    key: path || $$.randomStr(4),\n    render: function render(props) {\n      return React.createElement(DocumentTitle, {\n        title: config.htmlTitle ? config.htmlTitle.replace(/{.*}/gi, title) : title,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 64\n        },\n        __self: this\n      }, React.createElement(Comp, Object.assign({\n        routerData: otherProps\n      }, props, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 69\n        },\n        __self: this\n      })));\n    }\n  }, path && {\n    path: path\n  });\n\n  if (indexRoute) {\n    return [React.createElement(Redirect, {\n      key: path + '_redirect',\n      exact: true,\n      from: path,\n      to: indexRoute,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80\n      },\n      __self: this\n    }), React.createElement(Route, Object.assign({}, routeProps, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 81\n      },\n      __self: this\n    }))];\n  }\n\n  return React.createElement(Route, Object.assign({}, routeProps, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }));\n};","map":{"version":3,"sources":["/Users/evan/progressMan/src/utils/core.js"],"names":["React","dynamic","Route","Switch","Redirect","DocumentTitle","assign","$$","config","dynamicWrapper","app","models","component","createRoutes","routesConfig","map","createRoute","window","dva_router_pathMap","Comp","path","indexRoute","title","otherProps","childRoutes","length","forEach","item","key","parentPath","routeProps","randomStr","render","props","htmlTitle","replace"],"mappings":"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","sourcesContent":["import React from 'react';\nimport dynamic from 'dva/dynamic';\nimport { Route, Switch, Redirect } from 'dva/router';\nimport DocumentTitle from 'react-document-title';\nimport assign from 'object-assign';\nimport $$ from 'cmn-utils';\nimport config from '@/config';\n\n/**\n * 生成动态组件\n * @param {*} app\n * @param {*} models\n * @param {*} component\n */\nexport const dynamicWrapper = (app, models, component) =>\n  dynamic({\n    app,\n    models: () => models,\n    component\n  });\n\n/**\n * 生成一组路由\n * @param {*} app\n * @param {*} routesConfig\n */\nexport const createRoutes = (app, routesConfig) => {\n  return (\n    <Switch>\n      {routesConfig(app).map(config => createRoute(app, () => config))}\n    </Switch>\n  );\n};\n// 路由映射表\nwindow.dva_router_pathMap = {};\n/**\n * 生成单个路由\n * @param {*} app\n * @param {*} routesConfig\n */\nexport const createRoute = (app, routesConfig) => {\n  const {\n    component: Comp,\n    path,\n    indexRoute,\n    title,\n    ...otherProps\n  } = routesConfig(app);\n  if (path && path !== '/') {\n    window.dva_router_pathMap[path] = { path, title, ...otherProps };\n    // 为子路由增加parentPath\n    if (otherProps.childRoutes && otherProps.childRoutes.length) {\n      otherProps.childRoutes.forEach(item => {\n        if (window.dva_router_pathMap[item.key]) {\n          window.dva_router_pathMap[item.key].parentPath = path;\n        }\n      });\n    }\n  }\n  const routeProps = assign(\n    {\n      key: path || $$.randomStr(4),\n      render: props => (\n        <DocumentTitle\n          title={\n            config.htmlTitle ? config.htmlTitle.replace(/{.*}/gi, title) : title\n          }\n        >\n          <Comp routerData={otherProps} {...props} />\n        </DocumentTitle>\n      )\n    },\n    path && {\n      path: path\n    }\n  );\n\n  if (indexRoute) {\n    return [\n      <Redirect key={path + '_redirect'} exact from={path} to={indexRoute} />,\n      <Route {...routeProps} />\n    ];\n  }\n\n  return <Route {...routeProps} />;\n};\n"]},"metadata":{},"sourceType":"module"}