{"ast":null,"code":"import _objectSpread from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _classCallCheck from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport $$ from 'cmn-utils';\nimport PageHelper from './index';\n/**\n * 分页对象\n */\n\nvar PageInfo =\n/*#__PURE__*/\nfunction () {\n  function PageInfo() {\n    _classCallCheck(this, PageInfo);\n\n    this.pageNum = 1;\n    this.pageSize = 10;\n    this.size = 0;\n    this.total = 0;\n    this.totalPages = 0;\n    this.list = [];\n    this.filters = {};\n    this.sorts = {};\n    this.reasonable = false;\n  }\n\n  _createClass(PageInfo, [{\n    key: \"startPage\",\n\n    /**\n     * 组装分页信息\n     * @param {number} pageNum page number, default 1\n     * @param {number} pageSize page size, default 10\n     */\n    value: function startPage() {\n      var pageNum = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n      var pageSize = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 10;\n      this.pageNum = pageNum;\n      this.pageSize = pageSize;\n      this.size = 0;\n      this.total = 0;\n      this.totalPages = 0;\n      this.list = [];\n      this.filters = {};\n      this.sorts = {};\n      return this;\n    }\n    /**\n     * 组装分页信息\n     * @param {number} pageNum page number\n     * @param {number} pageSize page size\n     */\n\n  }, {\n    key: \"jumpPage\",\n    value: function jumpPage(pageNum, pageSize) {\n      if (pageNum && pageNum <= Math.ceil(this.totalPages) || pageNum === 1) {\n        this.pageNum = pageNum;\n        if (pageSize) this.pageSize = pageSize;\n      }\n\n      return this;\n    }\n    /**\n     * 拼接过滤条件\n     * @param {object} q 过滤条件 {name: 'jonn', sex: 1}\n     * @param {boolean} merge 是否将新条件与现有条件合并\n     */\n\n  }, {\n    key: \"filter\",\n    value: function filter(q, merge) {\n      if ($$.isObject(q)) {\n        if (merge) {\n          this.filters = _objectSpread({}, this.filters, q);\n        } else {\n          this.filters = q;\n        }\n      }\n\n      return this;\n    }\n    /**\n     * 拼接排序条件\n     * @param {object} q 排序字段 {name: 'asc', age: 'desc'}\n     */\n\n  }, {\n    key: \"sortBy\",\n    value: function sortBy(q) {\n      if ($$.isObject(q)) {\n        this.sorts = q;\n      }\n\n      return this;\n    }\n    /**\n     * 下一页或指定页数\n     * @param {number} pageNum \n     */\n\n  }, {\n    key: \"nextPage\",\n    value: function nextPage(pageNum) {\n      if (this.totalPages !== -1) {\n        if (pageNum && pageNum <= Math.ceil(this.totalPages)) {\n          this.pageNum = pageNum;\n        } else if (this.pageNum + 1 <= Math.ceil(this.totalPages)) {\n          this.pageNum++;\n        }\n      } else {\n        this.pageNum = this.totalPages;\n      }\n\n      return this;\n    }\n    /**\n     * 上一页\n     */\n\n  }, {\n    key: \"prevPage\",\n    value: function prevPage() {\n      if (this.totalPages !== -1) {\n        if (this.pageNum - 1 > 0) {\n          this.pageNum--;\n        }\n      } else {\n        this.pageNum = 1;\n      }\n\n      return this;\n    } // deprecate\n\n  }, {\n    key: \"send\",\n    value: function send(url, options) {\n      var self = this;\n      var pageNum = this.pageNum,\n          pageSize = this.pageSize,\n          filters = this.filters,\n          sorts = this.sorts;\n      var data = {\n        pageNum: pageNum,\n        pageSize: pageSize,\n        filters: filters,\n        sorts: sorts\n      };\n\n      if ($$.isFunction(PageHelper.requestFormat)) {\n        data = PageHelper.requestFormat(this);\n      }\n\n      return $$.send(url, _objectSpread({\n        data: data\n      }, options)).then(function (resp) {\n        if ($$.isFunction(PageHelper.responseFormat)) {\n          var newPageInfo = PageHelper.responseFormat(resp);\n          return Object.assign(self, newPageInfo);\n        }\n      });\n    }\n  }]);\n\n  return PageInfo;\n}();\n\nexport { PageInfo as default };","map":{"version":3,"sources":["/Users/evan/progressMan/src/utils/pageHelper/PageInfo.js"],"names":["$$","PageHelper","PageInfo","pageNum","pageSize","size","total","totalPages","list","filters","sorts","reasonable","Math","ceil","q","merge","isObject","url","options","self","data","isFunction","requestFormat","send","then","resp","responseFormat","newPageInfo","Object","assign"],"mappings":"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","sourcesContent":["import $$ from 'cmn-utils';\nimport PageHelper from './index';\n/**\n * 分页对象\n */\nexport default class PageInfo {\n  // 页码，从1开始\n  pageNum = 1;\n\n  // 每页数量\n  pageSize = 10;\n\n  // 当前页的数量\n  size = 0;\n\n  // 总记录数\n  total = 0;\n\n  // 总页数\n  totalPages = 0;\n\n  // 结果集\n  list = [];\n\n  // 过滤条件 {name: 'jonn'}\n  filters = {};\n\n  // 排序条件 {name: 'asc', age: 'desc'}\n  sorts = {};\n\n  /**\n   * 希望用户输入的页数不在合法范围（第一页到最后一页之外）\n   * 时能够正确的响应到正确的结果页面，那么你可以配置reasonable为true，\n   * 这时如果pageNum<1,会查询第一页，如果pageNum>总页数,会查询最后一页\n   */\n  reasonable = false;\n\n  /**\n   * 组装分页信息\n   * @param {number} pageNum page number, default 1\n   * @param {number} pageSize page size, default 10\n   */\n  startPage(pageNum = 1, pageSize = 10) {\n    this.pageNum = pageNum;\n    this.pageSize = pageSize;\n    this.size = 0;\n    this.total = 0;\n    this.totalPages = 0;\n    this.list = [];\n    this.filters = {};\n    this.sorts = {};\n    return this;\n  }\n\n  /**\n   * 组装分页信息\n   * @param {number} pageNum page number\n   * @param {number} pageSize page size\n   */\n  jumpPage(pageNum, pageSize) {\n    if ((pageNum && pageNum <= Math.ceil(this.totalPages)) || pageNum === 1) {\n      this.pageNum = pageNum;\n      if (pageSize) this.pageSize = pageSize;\n    }\n    return this;\n  }\n\n  /**\n   * 拼接过滤条件\n   * @param {object} q 过滤条件 {name: 'jonn', sex: 1}\n   * @param {boolean} merge 是否将新条件与现有条件合并\n   */\n  filter(q, merge) {\n    if ($$.isObject(q)) {\n      if (merge) {\n        this.filters = {...this.filters, ...q};\n      } else {\n        this.filters = q;\n      }\n    }\n    return this;\n  }\n\n  /**\n   * 拼接排序条件\n   * @param {object} q 排序字段 {name: 'asc', age: 'desc'}\n   */\n  sortBy(q) {\n    if ($$.isObject(q)) {\n      this.sorts = q;\n    }\n    return this;\n  }\n\n  /**\n   * 下一页或指定页数\n   * @param {number} pageNum \n   */\n  nextPage(pageNum) {\n    if (this.totalPages !== -1) {\n      if (pageNum && pageNum <= Math.ceil(this.totalPages)) {\n        this.pageNum = pageNum;\n      } else if (this.pageNum + 1 <= Math.ceil(this.totalPages)) {\n        this.pageNum ++;\n      }\n    } else {\n      this.pageNum = this.totalPages;\n    }\n    return this;\n  }\n\n  /**\n   * 上一页\n   */\n  prevPage() {\n    if (this.totalPages !== -1) {\n      if (this.pageNum - 1 > 0) {\n        this.pageNum --;\n      }\n    } else {\n      this.pageNum = 1;\n    }\n    return this;\n  }\n\n  // deprecate\n  send(url, options) {\n    const self = this;\n    const { pageNum, pageSize, filters, sorts } = this;\n    let data = { pageNum, pageSize, filters, sorts };\n\n    if ($$.isFunction(PageHelper.requestFormat)) {\n      data = PageHelper.requestFormat(this);\n    }\n    return $$.send(url, { data, ...options }).then(resp => {\n      if ($$.isFunction(PageHelper.responseFormat)) {\n        const newPageInfo = PageHelper.responseFormat(resp);\n        return Object.assign(self, newPageInfo);\n      }\n    })\n  }\n} "]},"metadata":{},"sourceType":"module"}