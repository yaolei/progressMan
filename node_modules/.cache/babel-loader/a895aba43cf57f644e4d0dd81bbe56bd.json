{"ast":null,"code":"import _objectSpread from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport _objectWithoutProperties from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _classCallCheck from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/evan/progressMan/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/evan/progressMan/src/components/LazyLoad/LazyLoad.js\";\nimport React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport lazySizes from 'lazysizes';\nimport cx from 'classnames';\nimport $$ from 'cmn-utils';\nimport './style/index.less';\n\nvar LazyLoad =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(LazyLoad, _Component);\n\n  function LazyLoad() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, LazyLoad);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(LazyLoad)).call.apply(_getPrototypeOf2, [this].concat(args)));\n\n    _this.componentDidUpdate = function () {\n      if (!lazySizes) {\n        return;\n      }\n\n      if (!lazySizes.hC(_this.node, 'lazyloaded') && !lazySizes.hC(_this.node, 'lazyload')) {\n        lazySizes.aC(_this.node, 'lazyload');\n      }\n    };\n\n    return _this;\n  }\n\n  _createClass(LazyLoad, [{\n    key: \"componentWillUpdate\",\n    value: function componentWillUpdate(nextProps) {\n      var propsChanged = false;\n\n      for (var _i = 0, _arr = ['src', 'dataSizes', 'dataSrc', 'dataSrcSet', 'className', 'iframe']; _i < _arr.length; _i++) {\n        var propName = _arr[_i];\n        var prop = propName === 'dataSrcSet' ? this.handleSrcSet(this.props[propName]) : this.props[propName];\n        var nextProp = propName === 'dataSrcSet' ? this.handleSrcSet(nextProps[propName]) : nextProps[propName];\n\n        if (prop !== nextProp) {\n          propsChanged = true;\n          break;\n        }\n      }\n\n      if (propsChanged && lazySizes) {\n        if (lazySizes.hC(this.node, 'lazyloaded')) {\n          lazySizes.rC(this.node, 'lazyloaded');\n        }\n      }\n    }\n  }, {\n    key: \"handleSrcSet\",\n    value: function handleSrcSet(dataSrcSet) {\n      if ($$.isArray(dataSrcSet)) {\n        return dataSrcSet.join(',');\n      } else if (typeof dataSrcSet === 'string') {\n        return dataSrcSet;\n      } else {\n        return null;\n      }\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this.node.src = '';\n    }\n  }, {\n    key: \"onError\",\n    value: function onError(e) {\n      e.target.classList.add('lazyerror');\n      e.target.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          prefixCls = _this$props.prefixCls,\n          src = _this$props.src,\n          dataSizes = _this$props.dataSizes,\n          dataSrc = _this$props.dataSrc,\n          dataSrcSet = _this$props.dataSrcSet,\n          className = _this$props.className,\n          iframe = _this$props.iframe,\n          title = _this$props.title,\n          alt = _this$props.alt,\n          otherProps = _objectWithoutProperties(_this$props, [\"prefixCls\", \"src\", \"dataSizes\", \"dataSrc\", \"dataSrcSet\", \"className\", \"iframe\", \"title\", \"alt\"]);\n\n      var classNames = cx(prefixCls, 'lazyload', className);\n\n      var lazyProps = _objectSpread({}, otherProps, {\n        src: src\n      });\n\n      if (dataSrc) lazyProps['data-src'] = dataSrc;\n      if (dataSizes) lazyProps['data-sizes'] = dataSizes;\n\n      if (dataSrcSet) {\n        lazyProps['data-srcset'] = this.handleSrcSet(dataSrcSet);\n      }\n\n      if (iframe) {\n        return React.createElement(\"iframe\", Object.assign({\n          ref: function ref(node) {\n            return _this2.node = node;\n          },\n          className: classNames,\n          title: title,\n          frameBorder: \"0\"\n        }, lazyProps, {\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 113\n          },\n          __self: this\n        }));\n      }\n\n      return React.createElement(\"img\", Object.assign({\n        ref: function ref(node) {\n          return _this2.node = node;\n        },\n        className: classNames,\n        alt: alt,\n        onError: this.onError\n      }, lazyProps, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 123\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return LazyLoad;\n}(Component);\n\nLazyLoad.propTypes = {\n  src: PropTypes.string,\n  dataSizes: PropTypes.string,\n  dataSrc: PropTypes.string,\n  dataSrcSet: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n  className: PropTypes.string,\n  iframe: PropTypes.bool\n};\nLazyLoad.defaultProps = {\n  src: 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n  dataSizes: 'auto',\n  iframe: false,\n  prefixCls: 'antui-lazyload'\n};\nexport default LazyLoad;","map":{"version":3,"sources":["/Users/evan/progressMan/src/components/LazyLoad/LazyLoad.js"],"names":["React","Component","PropTypes","lazySizes","cx","$$","LazyLoad","componentDidUpdate","hC","node","aC","nextProps","propsChanged","propName","prop","handleSrcSet","props","nextProp","rC","dataSrcSet","isArray","join","src","e","target","classList","add","prefixCls","dataSizes","dataSrc","className","iframe","title","alt","otherProps","classNames","lazyProps","onError","propTypes","string","oneOfType","array","bool","defaultProps"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport PropTypes from 'prop-types';\nimport lazySizes from 'lazysizes';\nimport cx from 'classnames';\nimport $$ from 'cmn-utils';\nimport './style/index.less';\n\nclass LazyLoad extends Component {\n  static propTypes = {\n    src: PropTypes.string,\n    dataSizes: PropTypes.string,\n    dataSrc: PropTypes.string,\n    dataSrcSet: PropTypes.oneOfType([PropTypes.string, PropTypes.array]),\n    className: PropTypes.string,\n    iframe: PropTypes.bool\n  };\n\n  static defaultProps = {\n    src:\n      'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7',\n    dataSizes: 'auto',\n    iframe: false,\n    prefixCls: 'antui-lazyload'\n  };\n\n  componentWillUpdate(nextProps) {\n    let propsChanged = false;\n    for (let propName of [\n      'src',\n      'dataSizes',\n      'dataSrc',\n      'dataSrcSet',\n      'className',\n      'iframe'\n    ]) {\n      let prop =\n        propName === 'dataSrcSet'\n          ? this.handleSrcSet(this.props[propName])\n          : this.props[propName];\n      let nextProp =\n        propName === 'dataSrcSet'\n          ? this.handleSrcSet(nextProps[propName])\n          : nextProps[propName];\n      if (prop !== nextProp) {\n        propsChanged = true;\n        break;\n      }\n    }\n    if (propsChanged && lazySizes) {\n      if (lazySizes.hC(this.node, 'lazyloaded')) {\n        lazySizes.rC(this.node, 'lazyloaded');\n      }\n    }\n  }\n\n  handleSrcSet(dataSrcSet) {\n    if ($$.isArray(dataSrcSet)) {\n      return dataSrcSet.join(',');\n    } else if (typeof dataSrcSet === 'string') {\n      return dataSrcSet;\n    } else {\n      return null;\n    }\n  }\n\n  componentDidUpdate = () => {\n    if (!lazySizes) {\n      return;\n    }\n    if (\n      !lazySizes.hC(this.node, 'lazyloaded') &&\n      !lazySizes.hC(this.node, 'lazyload')\n    ) {\n      lazySizes.aC(this.node, 'lazyload');\n    }\n  };\n\n  componentWillUnmount() {\n    this.node.src = '';\n  }\n\n  onError(e) {\n    e.target.classList.add('lazyerror');\n    e.target.src =\n      'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n  }\n\n  render() {\n    const {\n      prefixCls,\n      src,\n      dataSizes,\n      dataSrc,\n      dataSrcSet,\n      className,\n      iframe,\n      title,\n      alt,\n      ...otherProps\n    } = this.props;\n\n    const classNames = cx(prefixCls, 'lazyload', className);\n\n    const lazyProps = { ...otherProps, src };\n    if (dataSrc) lazyProps['data-src'] = dataSrc;\n    if (dataSizes) lazyProps['data-sizes'] = dataSizes;\n    if (dataSrcSet) {\n      lazyProps['data-srcset'] = this.handleSrcSet(dataSrcSet);\n    }\n\n    if (iframe) {\n      return (\n        <iframe\n          ref={node => (this.node = node)}\n          className={classNames}\n          title={title}\n          frameBorder=\"0\"\n          {...lazyProps}\n        />\n      );\n    }\n    return (\n      <img\n        ref={node => (this.node = node)}\n        className={classNames}\n        alt={alt}\n        onError={this.onError}\n        {...lazyProps}\n      />\n    );\n  }\n}\n\nexport default LazyLoad;\n"]},"metadata":{},"sourceType":"module"}