{"map":"{\"version\":3,\"sources\":[\"/Users/evan/progressMan/src/routes/Login/service/index.js\",\"/Users/evan/progressMan/src/routes/Login/model/index.js\"],\"names\":[\"login\",\"_x\",\"_login\",\"apply\",\"this\",\"arguments\",\"_callee\",\"payload\",\"regenerator_default\",\"a\",\"wrap\",\"_context\",\"prev\",\"next\",\"abrupt\",\"$$\",\"post\",\"stop\",\"__webpack_exports__\",\"namespace\",\"state\",\"loggedIn\",\"message\",\"user\",\"subscriptions\",\"setup\",\"_ref\",\"history\",\"dispatch\",\"listen\",\"_ref2\",\"pathname\",\"indexOf\",\"removeStore\",\"effects\",\"mark\",\"_ref3\",\"_ref4\",\"call\",\"put\",\"_ref5\",\"status\",\"data\",\"sent\",\"setStore\",\"routerRedux\",\"replace\",\"type\",\"logout\",\"_\",\"_ref6\",\"_context2\",\"reducers\",\"loginSuccess\",\"_ref7\",\"Object\",\"objectSpread\",\"loginError\",\"_ref8\"],\"mappings\":\"iKAEO,SAAeA,EAAtBC,GAAA,OAAAC,EAAAC,MAAAC,KAAAC,sDAAO,SAAAC,EAAqBC,GAArB,OAAAC,EAAAC,EAAAC,KAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAAA,OAAAF,EAAAG,OAAA,SACEC,EAAAA,EAAGC,KAAK,cAAeT,IADzB,KAAA,EAAA,IAAA,MAAA,OAAAI,EAAAM,SAAAX,6BCEQY,EAAA,QAAA,CACbC,UAAW,QAEXC,MAAO,CACLC,UAAU,EACVC,QAAS,GACTC,KAAM,IAGRC,cAAe,CACbC,MADa,SAAAC,GACgB,IAArBC,EAAqBD,EAArBC,QAAqBD,EAAZE,SACf,OAAOD,EAAQE,OAAO,SAAAC,IACqB,IADHA,EAAfC,SACVC,QAAQ,gBACnBjB,EAAAA,EAAGkB,YAAY,YAMvBC,QAAS,CACNlC,MADMQ,EAAAC,EAAA0B,KAAA,SAAAnC,EAAAoC,EAAAC,GAAA,IAAA9B,EAAA+B,EAAAC,EAAAC,EAAAC,EAAAnB,EAAAoB,EAAA,OAAAlC,EAAAC,EAAAC,KAAA,SAAAC,GAAA,OAAA,OAAAA,EAAAC,KAAAD,EAAAE,MAAA,KAAA,EAE6B,OAD3BN,EADF6B,EACE7B,QAAa+B,EADfD,EACeC,KAAMC,EADrBF,EACqBE,IADrB5B,EAAAE,KAAA,EAEmCyB,EAAKtC,EAAOO,GAF/C,KAAA,EAAA,GAAAiC,EAAA7B,EAAAgC,KAEGF,EAFHD,EAEGC,OAAQnB,EAFXkB,EAEWlB,QAASoB,EAFpBF,EAEoBE,MACrBD,EAHC,CAAA9B,EAAAE,KAAA,GAAA,MAKH,OADAE,EAAAA,EAAG6B,SAAS,OAAQF,GAJjB/B,EAAAE,KAAA,GAKG0B,EAAIM,EAAAA,YAAYC,QAAQ,MAL3B,KAAA,GAAAnC,EAAAE,KAAA,GAAA,MAAA,KAAA,GAOH,OAPGF,EAAAE,KAAA,GAOG0B,EAAI,CACRQ,KAAM,aACNxC,QAAS,CAAEe,QAAAA,KATV,KAAA,GAAA,IAAA,MAAA,OAAAX,EAAAM,SAAAjB,KAaNgD,OAbMxC,EAAAC,EAAA0B,KAAA,SAAAa,EAaCC,EAbDC,GAAA,OAAA1C,EAAAC,EAAAC,KAAA,SAAAyC,GAAA,OAAA,OAAAA,EAAAvC,KAAAuC,EAAAtC,MAAA,KAAA,EAAAqC,EAaMX,IAbN,KAAA,EAAA,IAAA,MAAA,OAAAY,EAAAlC,SAAA+B,MAgBTI,SAAU,CACRC,aADQ,SACKjC,EADLkC,GACyB,IAAX/C,EAAW+C,EAAX/C,QACpB,OAAOgD,OAAAC,EAAA,EAAAD,CAAA,GACFnC,EADL,CAEEC,UAAU,EACVC,QAAS,GACTC,KAAMhB,KAGVkD,WATQ,SASGrC,EATHsC,GASuB,IAAXnD,EAAWmD,EAAXnD,QAClB,OAAOgD,OAAAC,EAAA,EAAAD,CAAA,GACFnC,EADL,CAEEC,UAAU,EACVC,QAASf,EAAQe\",\"sourcesContent\":[\"import $$ from 'cmn-utils';\\n\\nexport async function login(payload) {\\n  return $$.post('/user/login', payload);\\n}\",\"import { routerRedux } from 'dva/router';\\nimport { login } from '../service';\\nimport $$ from 'cmn-utils';\\n\\nexport default {\\n  namespace: 'login',\\n\\n  state: {\\n    loggedIn: false,\\n    message: '',\\n    user: {},\\n  },\\n\\n  subscriptions: {\\n    setup({ history, dispatch }) {\\n      return history.listen(({ pathname }) => {\\n        if (pathname.indexOf('/sign/login') !== -1) {\\n          $$.removeStore('user');\\n        }\\n      });\\n    }\\n  },\\n\\n  effects: {\\n    *login({ payload }, { call, put }) {\\n      const { status, message, data } = yield call(login, payload);\\n      if (status) {\\n        $$.setStore('user', data);\\n        yield put(routerRedux.replace('/'));\\n      } else {\\n        yield put({\\n          type: 'loginError',\\n          payload: { message }\\n        });\\n      }\\n    },\\n    *logout(_, { put }) {}\\n  },\\n\\n  reducers: {\\n    loginSuccess(state, { payload }) {\\n      return {\\n        ...state,\\n        loggedIn: true,\\n        message: '',\\n        user: payload\\n      };\\n    },\\n    loginError(state, { payload }) {\\n      return {\\n        ...state,\\n        loggedIn: false,\\n        message: payload.message\\n      };\\n    },\\n  }\\n};\\n\"]}","code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[41],{1773:function(e,n,r){\"use strict\";r.r(n);var t=r(26),a=r(49),s=r.n(a),o=r(20),u=r(155),c=r(9),i=r.n(c);function p(e){return l.apply(this,arguments)}function l(){return(l=Object(u.a)(s.a.mark(function e(n){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt(\"return\",i.a.post(\"/user/login\",n));case 1:case\"end\":return e.stop()}},e)}))).apply(this,arguments)}n.default={namespace:\"login\",state:{loggedIn:!1,message:\"\",user:{}},subscriptions:{setup:function(e){var n=e.history;e.dispatch;return n.listen(function(e){-1!==e.pathname.indexOf(\"/sign/login\")&&i.a.removeStore(\"user\")})}},effects:{login:s.a.mark(function e(n,r){var t,a,u,c,l,f,g;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=n.payload,a=r.call,u=r.put,e.next=4,a(p,t);case 4:if(c=e.sent,l=c.status,f=c.message,g=c.data,!l){e.next=14;break}return i.a.setStore(\"user\",g),e.next=12,u(o.routerRedux.replace(\"/\"));case 12:e.next=16;break;case 14:return e.next=16,u({type:\"loginError\",payload:{message:f}});case 16:case\"end\":return e.stop()}},e)}),logout:s.a.mark(function e(n,r){return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.put;case 1:case\"end\":return e.stop()}},e)})},reducers:{loginSuccess:function(e,n){var r=n.payload;return Object(t.a)({},e,{loggedIn:!0,message:\"\",user:r})},loginError:function(e,n){var r=n.payload;return Object(t.a)({},e,{loggedIn:!1,message:r.message})}}}}}]);","extractedComments":[]}