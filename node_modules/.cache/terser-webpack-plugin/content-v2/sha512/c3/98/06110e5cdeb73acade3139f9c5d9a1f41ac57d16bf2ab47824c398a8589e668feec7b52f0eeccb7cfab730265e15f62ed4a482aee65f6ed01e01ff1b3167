{"map":"{\"version\":3,\"sources\":[\"/Users/evan/progressMan/src/routes/Business/CRUD/model/index.js\"],\"names\":[\"LOADED\",\"modelEnhance\",\"namespace\",\"state\",\"pageData\",\"PageHelper\",\"create\",\"employees\",\"subscriptions\",\"setup\",\"_ref\",\"dispatch\",\"history\",\"listen\",\"_ref2\",\"pathname\",\"type\",\"effects\",\"init\",\"_Users_evan_progressMan_node_modules_babel_preset_react_app_node_modules_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default\",\"a\",\"mark\",\"_ref3\",\"_ref4\",\"put\",\"select\",\"_ref5\",\"wrap\",\"_context\",\"prev\",\"next\",\"payload\",\"call\",\"crud\",\"sent\",\"startPage\",\"stop\",\"getPageInfo\",\"_ref6\",\"_ref7\",\"_context2\",\"valueField\",\"url\",\"pageInfo\",\"save\",\"_ref8\",\"_ref9\",\"take\",\"values\",\"success\",\"_ref10\",\"_context3\",\"notice\",\"data\",\"update\",\"_ref11\",\"_ref12\",\"_context4\",\"remove\",\"_ref13\",\"_ref14\",\"records\",\"_ref15\",\"_context5\",\"map\",\"item\",\"rowKey\",\"getEmployees\",\"_ref16\",\"_ref17\",\"_context6\",\"afterResponse\",\"resp\",\"reducers\"],\"mappings\":\"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\",\"sourcesContent\":[\"import modelEnhance from '@/utils/modelEnhance';\\nimport PageHelper from '@/utils/pageHelper';\\n/**\\n * 当第一次加载完页面时为true\\n * 可以用这个值阻止切换页面时\\n * 多次初始化数据\\n */\\nlet LOADED = false;\\nexport default modelEnhance({\\n  namespace: 'crud',\\n\\n  state: {\\n    pageData: PageHelper.create(),\\n    employees: []\\n  },\\n\\n  subscriptions: {\\n    setup({ dispatch, history }) {\\n      history.listen(({ pathname }) => {\\n        if (pathname === '/crud' && !LOADED) {\\n          LOADED = true;\\n          dispatch({\\n            type: 'init'\\n          });\\n        }\\n      });\\n    }\\n  },\\n\\n  effects: {\\n    // 进入页面加载\\n    *init({ payload }, { call, put, select }) {\\n      const { pageData } = yield select(state => state.crud);\\n      yield put({\\n        type: 'getPageInfo',\\n        payload: {\\n          pageData: pageData.startPage(1, 10)\\n        }\\n      });\\n      yield put({\\n        type: 'getEmployees'\\n      });\\n    },\\n    // 获取分页数据\\n    *getPageInfo({ payload }, { call, put }) {\\n      const { pageData } = payload;\\n      yield put({\\n        type: '@request',\\n        payload: {\\n          valueField: 'pageData',\\n          url: '/crud/getList',\\n          pageInfo: pageData\\n        }\\n      });\\n    },\\n    // 保存 之后查询分页\\n    *save({ payload }, { call, put, select, take }) {\\n      const { values, success } = payload;\\n      const { pageData } = yield select(state => state.crud);\\n      yield put({\\n        type: '@request',\\n        payload: {\\n          notice: true,\\n          url: '/crud/save',\\n          data: values\\n        }\\n      });\\n      // 等待@request结束\\n      yield take('@request/@@end');\\n      yield put({\\n        type: 'getPageInfo',\\n        payload: { pageData }\\n      });\\n      success();\\n    },\\n    // 修改\\n    *update({ payload }, { call, put }) {},\\n    // 删除 之后查询分页\\n    *remove({ payload }, { call, put, select }) {\\n      const { records, success } = payload;\\n      const { pageData } = yield select(state => state.crud);\\n      yield put({\\n        type: '@request',\\n        payload: {\\n          notice: true,\\n          url: '/crud/bathDelete',\\n          data: records.map(item => item.rowKey)\\n        }\\n      });\\n      yield put({\\n        type: 'getPageInfo',\\n        payload: { pageData }\\n      });\\n      success();\\n    },\\n    // 获取员工列表\\n    *getEmployees({ payload }, { call, put }) {\\n      yield put({\\n        type: '@request',\\n        afterResponse: resp => resp.data,\\n        payload: {\\n          valueField: 'employees',\\n          url: '/crud/getWorkEmployee'\\n        }\\n      });\\n    }\\n  },\\n\\n  reducers: {}\\n});\\n\"]}","code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{1767:function(e,a,t){\"use strict\";t.r(a);var r=t(49),n=t.n(r),c=t(258),u=t(129),s=!1;a.default=Object(c.a)({namespace:\"crud\",state:{pageData:u.a.create(),employees:[]},subscriptions:{setup:function(e){var a=e.dispatch;e.history.listen(function(e){\"/crud\"!==e.pathname||s||(s=!0,a({type:\"init\"}))})}},effects:{init:n.a.mark(function e(a,t){var r,c,u,s;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.payload,t.call,r=t.put,c=t.select,e.next=4,c(function(e){return e.crud});case 4:return u=e.sent,s=u.pageData,e.next=8,r({type:\"getPageInfo\",payload:{pageData:s.startPage(1,10)}});case 8:return e.next=10,r({type:\"getEmployees\"});case 10:case\"end\":return e.stop()}},e)}),getPageInfo:n.a.mark(function e(a,t){var r,c,u;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.payload,t.call,c=t.put,u=r.pageData,e.next=5,c({type:\"@request\",payload:{valueField:\"pageData\",url:\"/crud/getList\",pageInfo:u}});case 5:case\"end\":return e.stop()}},e)}),save:n.a.mark(function e(a,t){var r,c,u,s,p,o,l,i;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.payload,t.call,c=t.put,u=t.select,s=t.take,p=r.values,o=r.success,e.next=5,u(function(e){return e.crud});case 5:return l=e.sent,i=l.pageData,e.next=9,c({type:\"@request\",payload:{notice:!0,url:\"/crud/save\",data:p}});case 9:return e.next=11,s(\"@request/@@end\");case 11:return e.next=13,c({type:\"getPageInfo\",payload:{pageData:i}});case 13:o();case 14:case\"end\":return e.stop()}},e)}),update:n.a.mark(function e(a,t){return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:a.payload,t.call,t.put;case 2:case\"end\":return e.stop()}},e)}),remove:n.a.mark(function e(a,t){var r,c,u,s,p,o,l;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=a.payload,t.call,c=t.put,u=t.select,s=r.records,p=r.success,e.next=5,u(function(e){return e.crud});case 5:return o=e.sent,l=o.pageData,e.next=9,c({type:\"@request\",payload:{notice:!0,url:\"/crud/bathDelete\",data:s.map(function(e){return e.rowKey})}});case 9:return e.next=11,c({type:\"getPageInfo\",payload:{pageData:l}});case 11:p();case 12:case\"end\":return e.stop()}},e)}),getEmployees:n.a.mark(function e(a,t){var r;return n.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a.payload,t.call,r=t.put,e.next=4,r({type:\"@request\",afterResponse:function(e){return e.data},payload:{valueField:\"employees\",url:\"/crud/getWorkEmployee\"}});case 4:case\"end\":return e.stop()}},e)})},reducers:{}})}}]);","extractedComments":[]}